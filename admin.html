<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin - Add Event</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://accounts.google.com/gsi/client" async defer></script>
</head>
<body>
    <header>
        <h1>Admin - Add Event</h1>
    </header>
    <nav>
        <a href="index.html">Home</a>
        <a href="Memories.html">Memories</a>
        <a href="UpcomingEvents.html">Upcoming Events</a>
        <a href="Donation.html">Donation</a>
        <a href="AboutUs.html">About Us</a>
        <a href="admin.html" class="active">Admin</a>
    </nav>
    <div class="container">
        <form id="event-form" class="vertical-form">
            <label for="event-name">Event Name:</label>
            <input type="text" id="event-name" placeholder="Enter event name" required>
            <label for="event-date">Event Date:</label>
            <input type="date" id="event-date" required>
            <label for="event-time">Event Time:</label>
            <input type="time" id="event-time" required>
            <label for="event-description">Event Description:</label>
            <textarea id="event-description" placeholder="Enter event description" required></textarea>
            <button type="submit">Add Event</button>
        </form>
        <p id="submission-status" style="display: none; color: green;">Event submitted successfully!</p>
    </div>
    <footer>
        Â© 2024 DevelopersKvp
    </footer>
    <script>
        function onGoogleSignIn(response) {
            console.log("Google user signed in:", response);
            loadGoogleAPI(); // Proceed to load the Drive API after successful sign-in
        }

        function loadGoogleAPI() {
            gapi.load('client', ('client:auth2', initClient) => {
                gapi.client.init({
                    apiKey: 'AIzaSyC1P0ETn3zKPFjvcWlf2mLyCpKUZQw3K1I', // Replace with your API key
                    discoveryDocs: ['https://www.googleapis.com/discovery/v1/apis/drive/v3/rest'],
                }).then(() => {
                    console.log("Google API client initialized.");
                    // Add your Drive API interaction code here
                }).catch(error => {
                    console.error("Error initializing Google API client:", error);
                });
            });
        }

        // Handle form submission
        document.getElementById('event-form').addEventListener('submit', function (e) {
            e.preventDefault();
            const eventName = document.getElementById('event-name').value;
            const eventDate = document.getElementById('event-date').value;
            const eventTime = document.getElementById('event-time').value;
            const eventDescription = document.getElementById('event-description').value;
            const eventData = { name: eventName, date: eventDate, time: eventTime, description: eventDescription };
            uploadEvent(eventData);
        });

        function uploadEvent(eventData) {
            const fileMetadata = {
                name: `event-${new Date().getTime()}.json`,
                mimeType: 'application/json',
                parents: ['1WSBUa2IPeZrxVZCKLxC-KeTFupHxoCIs'],
            };
            const media = {
                mimeType: 'application/json',
                body: JSON.stringify(eventData),
            };
            gapi.client.drive.files.create({
                resource: fileMetadata,
                media: media,
                fields: 'id',
            }).then(response => {
                console.log('Event uploaded:', response.result);
                showSubmissionStatus(true);
            }).catch(error => {
                console.error('Error uploading event:', error);
                showSubmissionStatus(false);
            });
        }

        function showSubmissionStatus(success) {
            const statusElement = document.getElementById('submission-status');
            if (success) {
                statusElement.textContent = 'Event submitted successfully!';
                statusElement.style.color = 'green';
            } else {
                statusElement.textContent = 'Failed to submit event. Please try again.';
                statusElement.style.color = 'red';
            }
            statusElement.style.display = 'block';
            setTimeout(() => {
                statusElement.style.display = 'none';
            }, 3000);
        }
    </script>
</body>
</html>

